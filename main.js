(()=>{"use strict";const e=new class{constructor(){this.questions,this.questionNumber=0,this.questionAmount,this.score=0,this.category,this.timeOut}initiateGame(e,s){this.questions=e.results,this.questionAmount=t.questionsAmount.value,this.category=s}nextQuestion(){this.questionNumber++}checkAnswer(e){const s=e.textContent,n=this.questions[this.questionNumber].correct_answer;t.addBtnClasses(e,n),s===n?(this.score++,t.playSoundEffect("correct")):t.playSoundEffect("incorrect"),t.updateScore(this.score)}setTimeout(){this.timeOut=setTimeout((()=>{t.timeoutRevealAnswer()}),1e4)}cancelTimeOut(){clearTimeout(this.timeOut)}resetGame(){this.questionNumber=0,this.score=0}},t=new class{constructor(){this.question=document.querySelector(".question"),this.answerBtns=Array.from(document.querySelectorAll(".answer-btn")),this.answerBtnGroup=document.querySelector(".answer-btn-group"),this.progress=document.querySelector(".progress-bar"),this.progressText=document.querySelector(".progress-text"),this.nextQuestion=document.querySelector(".next-question"),this.score=document.querySelector(".score"),this.questionsAmount=document.querySelector("#question-amount"),this.difficulty=document.querySelector("#difficulty"),this.categorySelections=Array.from(document.querySelectorAll(".image-div")),this.startScreen=document.querySelector(".start-screen-state"),this.gameplayScreen=document.querySelector(".game-play-state"),this.endScreen=document.querySelector(".end-screen-state"),this.settingsBtn=document.querySelector(".setting-btn"),this.playAgainBtn=document.querySelector(".play-again"),this.returnHomeBtn=document.querySelector(".return-home"),this.endScore=document.querySelector(".end-score"),this.correct=new Audio("./audio/correct_answer.mp3"),this.incorrect=new Audio("./audio/wrong_answer.mp3"),this.countdown=new Audio("./audio/countdown.mp3")}populateQuestionUi(){const t=e.questions[e.questionNumber],s=Math.floor(6*Math.random()),n=t.incorrect_answers;this.question.textContent=this.replaceSpecialCharacters(t.question),this.updateProgressBar(),n.splice(s,0,t.correct_answer);for(let e=0;e<n.length;e++)this.answerBtns[e].textContent=this.replaceSpecialCharacters(n[e])}replaceSpecialCharacters(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value}addBtnClasses(e,s){s=t.replaceSpecialCharacters(s),e.textContent!==s&&(e.classList.remove("btn-info"),e.classList.add("btn-danger")),this.answerBtns.forEach((e=>{e.disabled="true",e.textContent===s&&(e.classList.remove("btn-info"),e.classList.add("btn-success"))}))}timeoutRevealAnswer(){const s=this.replaceSpecialCharacters(e.questions[e.questionNumber].correct_answer);this.answerBtns.forEach((e=>{e.disabled="true",e.textContent===s&&(e.classList.remove("btn-info"),e.classList.add("btn-success"))})),e.questionNumber+1<e.questionAmount?t.showAndHideNextQuestionButton():setTimeout((function(){t.hideShowGameplayScreen(),t.setScoreEndScreen(),t.showHideEndScreen()}),1e3)}removeBtnClasses(){this.answerBtns.forEach((e=>{e.disabled="",e.classList.remove("btn-info"),e.classList.remove("btn-success"),e.classList.remove("btn-danger"),e.classList.add("btn-info")}))}playSoundEffect(e){"correct"===e?this.correct.play():this.incorrect.play()}playCountDownTimer(){this.countdown.play()}stopCountDownTimer(){this.countdown.pause(),this.countdown.currentTime=0}answerTimeoutStart(){}updateScore(){this.score.textContent=e.score}showAndHideNextQuestionButton(){this.nextQuestion.classList.toggle("hide")}hideShowStartScreen(){this.startScreen.classList.toggle("display-none")}hideShowGameplayScreen(){this.gameplayScreen.classList.toggle("display-none"),this.settingsBtn.classList.toggle("display-none")}showHideEndScreen(){this.endScreen.classList.toggle("display-none")}setScoreEndScreen(){this.endScore.textContent=`${e.score}/${e.questionAmount}`}updateProgressBar(){const t=(e.questionNumber+1)/e.questions.length*100;this.progress.style.width=t+"%",this.progressText.textContent=`Question ${e.questionNumber+1} / ${e.questionAmount}`}},s=new class{async getQUizData(e){let s;s="Any"===t.difficulty.value?`https://opentdb.com/api.php?amount=${t.questionsAmount.value}&category=${e}&type=multiple`:`https://opentdb.com/api.php?amount=${t.questionsAmount.value}&category=${e}&difficulty=${t.difficulty.value}&type=multiple`;const n=await fetch(s);return await n.json()}};t.answerBtnGroup.addEventListener("click",(s=>{s.target.classList.contains("answer-btn")&&(t.stopCountDownTimer(),e.cancelTimeOut(),e.checkAnswer(s.target),e.questionNumber+1<e.questionAmount?t.showAndHideNextQuestionButton():setTimeout((function(){t.hideShowGameplayScreen(),t.setScoreEndScreen(),t.showHideEndScreen()}),1e3)),s.preventDefault()})),t.nextQuestion.addEventListener("click",(function(){e.questionNumber++,t.removeBtnClasses(),t.populateQuestionUi(),t.showAndHideNextQuestionButton(),t.playCountDownTimer(),e.setTimeout()})),t.categorySelections.forEach((n=>{n.addEventListener("click",(n=>{const o=n.target.dataset.category;s.getQUizData(o).then((s=>{e.initiateGame(s,o),t.populateQuestionUi(),t.hideShowStartScreen(),t.hideShowGameplayScreen(),t.playCountDownTimer(),e.setTimeout()}))}))})),t.playAgainBtn.addEventListener("click",(function(n){e.resetGame(),s.getQUizData(e.category).then((s=>{e.initiateGame(s,e.category),t.populateQuestionUi(),t.updateScore(),t.removeBtnClasses(),t.showHideEndScreen(),t.hideShowGameplayScreen(),t.playCountDownTimer(),e.setTimeout()}))})),t.returnHomeBtn.addEventListener("click",(function(){e.resetGame(),t.removeBtnClasses(),t.updateScore(),t.showHideEndScreen(),t.hideShowStartScreen()}))})();